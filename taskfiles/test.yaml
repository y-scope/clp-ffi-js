version: "3"

tasks:
  default:
    deps: ["js"]

  js:
    deps: [":clp-ffi-js", "node-modules"]
    cmd: "npm run test"

  node-modules:
    internal: true
    sources:
      - "{{.ROOT_DIR}}/package.json"
      - "{{.ROOT_DIR}}/package-lock.json"
      - "{{.TASKFILE}}"
    generates:
      - "{{.ROOT_DIR}}/node_modules/**/*"
    cmds:
      - "npm install"
